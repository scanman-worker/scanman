os: linux
dist: xenial
sudo: required
language: generic
notifications:
  email:
    on_success: never
    on_failure: never
script:
  - df -h
  - source .params.sh
  - docker pull ladar/scanman:latest
  - docker run --cap-add=CAP_MKNOD --privileged -ti ladar/scanman:latest bash -c "bash /root/scan.sh $ORG $BOX $PROVIDER $VERSION" | tee "$ORG-$BOX-$PROVIDER-$VERSION.txt"
  - echo $ORG $BOX $PROVIDER $VERSION finished.
  - docker run --cap-add=CAP_MKNOD --privileged -ti ladar/scanman:latest bash -c "bash /root/scan2.sh $ORG $BOX $PROVIDER $VERSION" | tee "$ORG-$BOX-$PROVIDER-$VERSION.2.txt"
  - git add "$ORG-$BOX-$PROVIDER-$VERSION.txt" && git rm .travis.yml
  - git commit -m "$ORG-$BOX-$PROVIDER-$VERSION results" && git push HEAD:$ORG-$BOX-$PROVIDER-$VERSION
